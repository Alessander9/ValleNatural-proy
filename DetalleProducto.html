<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Valle Natural - Detalle de Producto</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- ✅ GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    :root { --green-dark:#006838; --green:#1b9b5e; --green-soft:#e5f7f1; --orange:#ff8a00; }
    body { font-family:'Poppins',sans-serif; }

    .floating-whatsapp-btn{
      position: fixed; bottom: 40px; right: 40px;
      width: 70px; height: 70px; background: #25d366;
      border-radius: 50%; display: flex; align-items: center; justify-content: center;
      color: white; font-size: 38px; box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4);
      z-index: 999; text-decoration: none; transition: all 0.3s;
    }
    .floating-whatsapp-btn:hover{ transform: scale(1.1); box-shadow: 0 15px 35px rgba(37, 211, 102, 0.6); }

    .tooltip-wa{
      position: absolute; right: 85px; background: white; color: #333;
      padding: 10px 20px; border-radius: 12px; font-size: 0.9rem; font-weight: 600;
      white-space: nowrap; opacity: 0; visibility: hidden; transition: 0.3s; transform: translateX(15px);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,.1), 0 4px 6px -2px rgba(0,0,0,.05);
    }
    .tooltip-wa::after{
      content:''; position:absolute; right:-6px; top:50%; transform:translateY(-50%);
      width:0;height:0; border-top:6px solid transparent; border-bottom:6px solid transparent; border-left:6px solid white;
    }
    .floating-whatsapp-btn:hover .tooltip-wa{ opacity:1; visibility:visible; transform:translateX(0); }
  </style>

  <meta name="description" content="Detalle de producto Valle Natural.">
</head>

<body class="bg-gray-50 text-gray-800">

  <!-- Barra superior -->
  <div class="w-full bg-[var(--green-dark)] text-white text-sm">
    <div class="max-w-6xl mx-auto px-4 py-2 flex flex-wrap items-center justify-center gap-6">
      <span class="flex items-center gap-2">
        <span class="material-icons text-orange-300">local_shipping</span> Envíos a todo el Perú
      </span>
      <span class="flex items-center gap-2">
        <span class="material-icons text-orange-300">verified_user</span> Compra segura
      </span>
      <span class="flex items-center gap-2">
        <span class="material-icons text-orange-300">eco</span> Calidad natural garantizada
      </span>
    </div>
  </div>

  <!-- Header -->
  <header class="bg-white sticky top-0 z-50 border-b border-gray-100">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold flex items-center gap-2" style="color:var(--green-dark)">
        <span class="material-icons" style="color:var(--orange)">spa</span>
        Valle <span style="color:var(--orange)">Natural</span>
      </a>

      <button id="menuBtn" class="md:hidden text-gray-700">
        <span class="material-icons text-3xl">menu</span>
      </button>

      <nav id="mainNav" class="hidden md:flex items-center gap-6 font-semibold text-sm">
        <a href="index.html" class="hover:text-[var(--green)] flex items-center gap-1"><span class="material-icons text-base">home</span> Inicio</a>
        <a href="Productos.html" class="hover:text-[var(--green)] flex items-center gap-1"><span class="material-icons text-base">storefront</span> Productos</a>
        <a href="#" class="hover:text-[var(--green)] flex items-center gap-1"><span class="material-icons text-base">info</span> Nosotros</a>
        <a href="#" class="hover:text-[var(--green)] flex items-center gap-1"><span class="material-icons text-base">support_agent</span> Contacto</a>
      </nav>
    </div>

    <nav id="mobileNav" class="md:hidden hidden px-4 pb-4">
      <div class="flex flex-col gap-2 text-sm font-semibold bg-white border rounded-lg p-3">
        <a href="index.html" class="py-1 flex items-center gap-2"><span class="material-icons text-base">home</span> Inicio</a>
        <a href="Productos.html" class="py-1 flex items-center gap-2"><span class="material-icons text-base">storefront</span> Productos</a>
        <a href="#" class="py-1 flex items-center gap-2"><span class="material-icons text-base">info</span> Nosotros</a>
        <a href="#" class="py-1 flex items-center gap-2"><span class="material-icons text-base">support_agent</span> Contacto</a>
      </div>
    </nav>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-10">

    <!-- Breadcrumb -->
    <div class="text-sm text-gray-500 mb-6 flex items-center gap-2 page-breadcrumb">
      <span class="material-icons text-base text-gray-400">chevron_right</span>
      <a href="index.html" class="text-[var(--green)] hover:underline flex items-center gap-1">
        <span class="material-icons text-base">home</span> Inicio
      </a>
      <span class="mx-1 text-gray-300">/</span>
      <span class="flex items-center gap-1">
        <span class="material-icons text-base text-gray-400">science</span>
        <span id="bcName">Producto</span>
      </span>
    </div>

    <section class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start product-section">

      <!-- Imagen -->
      <div class="bg-white rounded-2xl shadow-sm p-4 border border-gray-100 product-image">
        <img id="prodImg" class="rounded-xl w-full h-96 object-cover"
             src=""
             alt="Producto">
      </div>

      <!-- Info -->
      <div class="product-info">
        <h1 id="prodTitle" class="text-3xl md:text-4xl font-extrabold text-gray-900 mb-3 flex items-center gap-2">
          <span class="material-icons" style="color:var(--orange)">local_fire_department</span>
          Producto
        </h1>

        <p id="prodDesc" class="text-gray-700 mb-5 flex items-start gap-2">
          <span class="material-icons text-gray-400 mt-0.5">info</span>
          Descripción del producto.
        </p>

        <div class="flex items-baseline gap-3 mb-6">
          <span id="prodPrice" class="text-3xl font-extrabold flex items-center gap-1" style="color:var(--green)">
            <span class="material-icons">sell</span> S/ 0.00
          </span>
        </div>

        <div class="grid sm:grid-cols-2 gap-4 mb-6">
          <div>
            <label for="presentacion" class="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
              <span class="material-icons text-base text-gray-500">inventory_2</span> Presentación
            </label>
            <select id="presentacion"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-[var(--green)]">
              <option selected>Única</option>
            </select>
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1">
              <span class="material-icons text-base text-gray-500">check_circle</span> Disponibilidad
            </label>
            <div class="px-3 py-2 rounded-lg border border-green-200 bg-[var(--green-soft)] text-[var(--green)] font-semibold flex items-center gap-2">
              <span class="material-icons text-base">verified</span> En stock
            </div>
          </div>
        </div>

        <!-- Métodos de pago (igual) -->
        <div class="bg-white border border-gray-100 rounded-2xl p-4 mb-6 payment-box">
          <h2 class="text-lg font-bold text-gray-900 mb-3 flex items-center gap-2">
            <span class="material-icons" style="color:var(--green)">payments</span>
            Métodos de pago
          </h2>

          <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
            <div class="border rounded-xl p-3 flex items-center gap-2">
              <span class="material-icons" style="color:var(--orange)">qr_code_2</span>
              <div>
                <div class="font-semibold">Yape</div>
                <div class="text-xs text-gray-500">Pago por QR / número</div>
              </div>
            </div>

            <div class="border rounded-xl p-3 flex items-center gap-2">
              <span class="material-icons" style="color:var(--orange)">qr_code</span>
              <div>
                <div class="font-semibold">Plin</div>
                <div class="text-xs text-gray-500">Pago por QR / número</div>
              </div>
            </div>

            <div class="border rounded-xl p-3 flex items-center gap-2">
              <span class="material-icons" style="color:var(--orange)">attach_money</span>
              <div>
                <div class="font-semibold">Efectivo</div>
                <div class="text-xs text-gray-500">Contra entrega</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Botones -->
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 action-buttons">
          <a id="btn-wa" href="https://wa.me/51967736074" target="_blank"
             class="inline-flex items-center justify-center gap-2 text-white font-semibold rounded-lg px-5 py-3 shadow"
             style="background-color:var(--green)">
            <i class="fab fa-whatsapp text-xl"></i> Comprar por WhatsApp
          </a>

          <a href="Productos.html"
             class="inline-flex items-center justify-center gap-2 border font-semibold rounded-lg px-5 py-3"
             style="border-color:var(--green); color:var(--green)">
            <span class="material-icons">arrow_back</span> Volver a Productos
          </a>
        </div>

        <!-- Utilidad -->
        <div class="mt-8 utility-box">
          <h2 class="text-lg font-bold text-gray-900 mb-3 flex items-center gap-2">
            <span class="material-icons" style="color:var(--green)">checklist</span>
            Utilidad
          </h2>
          <ul class="space-y-2 text-gray-700" id="utilList">
            <li class="flex items-start gap-2">
              <span class="material-icons text-base text-green-600 mt-0.5">task_alt</span>
              Producto natural para tu bienestar.
            </li>
          </ul>
        </div>

        <!-- Ficha técnica -->
        <div class="mt-6 tech-box">
          <h2 class="text-lg font-bold mb-3 flex items-center gap-2">
            <span class="material-icons" style="color:var(--green)">description</span>
            Ficha técnica
          </h2>

          <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm" id="techGrid">
            <div class="bg-white border rounded-lg p-3 flex items-start gap-2">
              <span class="material-icons text-gray-500">category</span>
              <div><span class="font-semibold">Categoría:</span> <span id="techCat">-</span></div>
            </div>
            <div class="bg-white border rounded-lg p-3 flex items-start gap-2">
              <span class="material-icons text-gray-500">public</span>
              <div><span class="font-semibold">Origen:</span> Perú</div>
            </div>
            <div class="bg-white border rounded-lg p-3 flex items-start gap-2">
              <span class="material-icons text-gray-500">ac_unit</span>
              <div><span class="font-semibold">Conservación:</span> Lugar fresco y seco</div>
            </div>
            <div class="bg-white border rounded-lg p-3 flex items-start gap-2">
              <span class="material-icons text-gray-500">event</span>
              <div><span class="font-semibold">Vida útil:</span> 12 meses</div>
            </div>
          </div>
        </div>

      </div>
    </section>

  </main>

  <footer class="mt-16 bg-gray-900 text-gray-300">
    <div class="max-w-6xl mx-auto px-4 py-8 grid md:grid-cols-3 gap-6 items-center">
      <div class="text-2xl font-extrabold flex items-center gap-2">
        <span class="material-icons text-white">spa</span>
        <span class="text-white">Valle</span> <span style="color:var(--green)">Natural</span>
      </div>
      <div class="text-sm text-gray-400">© 2025 Valle Natural. Todos los derechos reservados.</div>
    </div>
  </footer>

  <!-- WhatsApp flotante -->
  <a href="https://wa.me/51967736074" target="_blank" rel="noopener" class="floating-whatsapp-btn" aria-label="WhatsApp">
    <i class="fab fa-whatsapp"></i>
    <span class="tooltip-wa">¡Hola! ¿En qué te ayudo?</span>
  </a>

  <script>
    // Toggle menú móvil
    document.getElementById('menuBtn')?.addEventListener('click', ()=>{
      document.getElementById('mobileNav')?.classList.toggle('hidden');
    });

    // ==========================
    // ✅ Cargar producto por ?id=
    // ==========================
    const LS_KEY = "vn_products_v1";

    const params = new URLSearchParams(location.search);
    const id = params.get("id");

    const list = JSON.parse(localStorage.getItem(LS_KEY) || "[]");
    const p = list.find(x => x.id === id);

    if(!p){
      document.title = "Producto no encontrado | Valle Natural";
      document.getElementById("prodTitle").textContent = "Producto no encontrado";
      document.getElementById("prodDesc").innerHTML = `<span class="material-icons text-gray-400 mt-0.5">info</span> Este producto no existe o fue eliminado.`;
      document.getElementById("prodImg").src = "./img/alert.png";
    } else {
      // títulos / seo
      document.title = `Valle Natural - ${p.nombre}`;
      document.getElementById("bcName").textContent = p.nombre;
      document.getElementById("prodTitle").innerHTML = `<span class="material-icons" style="color:var(--orange)">local_fire_department</span> ${escapeHtml(p.nombre)}`;

      // imagen / descripción / precio
      document.getElementById("prodImg").src = p.imagen;
      document.getElementById("prodImg").alt = p.nombre;

      const desc = (p.descripcion && p.descripcion.trim()) ? p.descripcion.trim() : "Producto natural ideal para tu bienestar.";
      document.getElementById("prodDesc").innerHTML = `<span class="material-icons text-gray-400 mt-0.5">info</span> ${escapeHtml(desc)}`;

      document.getElementById("prodPrice").innerHTML = `<span class="material-icons">sell</span> S/ ${Number(p.precio).toFixed(2)}`;

      // categoría
      document.getElementById("techCat").textContent = prettyCat(p.categoria);

      // presentación (si luego guardas p.presentaciones como array)
      const sel = document.getElementById("presentacion");
      sel.innerHTML = "";
      const pres = Array.isArray(p.presentaciones) && p.presentaciones.length ? p.presentaciones : ["Única"];
      pres.forEach(x => {
        const opt = document.createElement("option");
        opt.textContent = x;
        sel.appendChild(opt);
      });

      // WhatsApp con presentación
      const wa = document.getElementById("btn-wa");
      function updateWA(){
        const presSel = sel.value || "";
        const price = `S/ ${Number(p.precio).toFixed(2)}`;
        const msg = encodeURIComponent(`Hola Valle Natural, me interesa ${p.nombre} (${presSel}) por ${price}. ¿Está disponible?`);
        wa.href = `https://wa.me/51967736074?text=${msg}`;
      }
      sel.addEventListener("change", updateWA);
      updateWA();
    }

    // GSAP animaciones
    document.addEventListener("DOMContentLoaded", () => {
      gsap.registerPlugin(ScrollTrigger);
      gsap.from("header", { y: -20, opacity: 0, duration: 0.6, ease: "power2.out" });
      gsap.from(".page-breadcrumb", { y: 10, opacity: 0, duration: 0.5, delay: 0.15, ease: "power2.out" });
      gsap.from(".product-image", { x: -25, opacity: 0, duration: 0.7, ease: "power2.out", delay: 0.1 });
      gsap.from(".product-info", { x: 25, opacity: 0, duration: 0.7, ease: "power2.out", delay: 0.15 });
    });

    function prettyCat(cat){
      const map = {
        "frutos_secos":"Frutos secos",
        "semillas":"Semillas",
        "granos_pops":"Granos / Pops",
        "superfoods_suplementos":"Superfoods / Suplementos",
        "endulzantes_infusiones":"Endulzantes e infusiones",
        "aceites":"Aceites",
      };
      return map[cat] || cat || "-";
    }

    function escapeHtml(str){
      return String(str).replace(/[&<>"']/g, m => ({
        '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;'
      }[m]));
    }
  </script>

</body>
</html>
  